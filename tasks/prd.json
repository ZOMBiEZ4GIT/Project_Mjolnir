{
  "project": "Mjolnir",
  "branchName": "ralph/b6-budget-polish-mobile",
  "description": "B-6: Budget Polish & Mobile — Mobile optimisation, transaction search, custom category management, spending trends, budget data export, and design token consistency.",
  "userStories": [
    {
      "id": "B6-001",
      "title": "Mobile-optimise budget dashboard",
      "description": "As a user on mobile, I want the budget dashboard to be touch-friendly and usable for quick balance checks.",
      "acceptanceCriteria": [
        "Budget dashboard page at /budget renders correctly on screens 320px-768px",
        "Category cards stack to single column on small screens (grid-cols-1 on smallest breakpoint)",
        "Payday countdown and savings indicator stack vertically on mobile",
        "Period selector uses large tap targets (minimum 44x44px touch areas)",
        "All text is readable without zooming on mobile viewports",
        "No horizontal scrolling on any viewport width down to 320px",
        "npm run build && npm run lint passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 1,
      "passes": false,
      "notes": ""
    },
    {
      "id": "B6-002",
      "title": "Mobile-optimise transaction list",
      "description": "As a user on mobile, I want the transaction list to be easy to scroll and interact with on my phone.",
      "acceptanceCriteria": [
        "Transaction rows at /budget/transactions are compact but readable on mobile",
        "Category override dropdown works with touch (not hover-only)",
        "Filter bar collapses into a filter icon button on mobile that expands a filter panel",
        "Search input is full-width on mobile",
        "Amount and date columns are not truncated on 320px viewport",
        "Visible refresh button for reloading transactions",
        "npm run build && npm run lint passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 2,
      "passes": false,
      "notes": ""
    },
    {
      "id": "B6-003",
      "title": "Transaction search with debounce",
      "description": "As a user, I want to search my transactions so I can find specific purchases.",
      "acceptanceCriteria": [
        "Create components/budget/TransactionSearch.tsx — search input with 300ms debounce",
        "Searches across description and raw_text fields (case-insensitive via existing ILIKE endpoint)",
        "Integrates with existing category and date filters on the transaction list page",
        "URL search params updated on filter change for bookmarkable filtered views",
        "Clear all filters button resets search, category, dates, and status",
        "Result count shown (e.g. 'Showing 23 transactions')",
        "npm run build && npm run lint passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 3,
      "passes": false,
      "notes": ""
    },
    {
      "id": "B6-004",
      "title": "Custom category management UI",
      "description": "As a user, I want to create and edit custom budget categories so I can track spending in ways that match my life.",
      "acceptanceCriteria": [
        "Create components/budget/CategoryManager.tsx — category management panel",
        "Accessible from the budget setup page via a 'Manage Categories' button",
        "Create new category form: name input, icon selector (searchable grid of common Lucide icons), colour picker (preset palette of 12-16 colours)",
        "Edit existing category: change name, icon, colour via same form",
        "Reorder categories via up/down arrow buttons on each row",
        "System categories (income, uncategorised) show as non-deletable with a lock icon",
        "Delete custom category button with confirmation — calls DELETE /api/budget/categories/[id]",
        "Uses existing POST/PUT/DELETE /api/budget/categories endpoints",
        "npm run build && npm run lint passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 4,
      "passes": false,
      "notes": ""
    },
    {
      "id": "B6-005",
      "title": "Spending trends API endpoint",
      "description": "As a developer, I need an endpoint that returns historical spending data across multiple periods for the trends component.",
      "acceptanceCriteria": [
        "Create GET /api/budget/trends endpoint protected by Clerk auth",
        "Accepts periods query param (default 6) for how many periods to include",
        "Returns array of period summaries ordered oldest to newest: periodId, startDate, endDate, totalSpentCents, totalIncomeCents, savingsRate, isProjected (true for current incomplete period), categories array (categoryId, name, colour, spentCents)",
        "Reuses calculateBudgetSummary for each period's data",
        "Current incomplete period included with isProjected: true",
        "npm run build && npm run lint passes"
      ],
      "priority": 5,
      "passes": false,
      "notes": ""
    },
    {
      "id": "B6-006",
      "title": "Spending trends chart component",
      "description": "As a user, I want to see how my spending compares month-over-month so I can track whether I'm improving.",
      "acceptanceCriteria": [
        "Create components/budget/SpendingTrends.tsx — month-over-month chart using Recharts (already in project)",
        "Bar chart showing total spending per period for the last 3-6 periods",
        "Category breakdown available as stacked bars (toggle between total and breakdown view)",
        "Savings rate shown as a line overlay on the chart",
        "Current incomplete period shown with dashed/lighter bars and 'Projected' label",
        "Responsive — works on desktop and mobile viewports",
        "Integrate into the budget dashboard page below the category cards",
        "npm run build && npm run lint passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 6,
      "passes": false,
      "notes": ""
    },
    {
      "id": "B6-007",
      "title": "Budget data export API endpoint",
      "description": "As a developer, I need an endpoint that generates CSV exports of budget and transaction data.",
      "acceptanceCriteria": [
        "Create GET /api/budget/export endpoint protected by Clerk auth",
        "Accepts type query param: 'transactions' or 'summary'",
        "Transactions CSV columns: date, description, raw_text, amount, status, category, settled_at",
        "Summary CSV columns: period_start, period_end, category, budgeted, spent, remaining, percentage_used",
        "Accepts optional from and to date range query params",
        "Returns CSV with Content-Type: text/csv and Content-Disposition: attachment with filename including date range",
        "CSV uses RFC 4180 formatting (proper escaping of commas and quotes)",
        "npm run build && npm run lint passes"
      ],
      "priority": 7,
      "passes": false,
      "notes": ""
    },
    {
      "id": "B6-008",
      "title": "Export buttons in UI",
      "description": "As a user, I want export buttons on the transaction list and dashboard so I can download my data easily.",
      "acceptanceCriteria": [
        "Add export dropdown button to /budget/transactions page: 'Export Transactions (CSV)'",
        "Add export option to /budget dashboard: 'Export Budget Summary (CSV)'",
        "Export respects current date range and category filters",
        "Shows loading state while CSV is being generated",
        "Browser downloads the file automatically via window.open or anchor download",
        "npm run build && npm run lint passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 8,
      "passes": false,
      "notes": ""
    },
    {
      "id": "B6-009",
      "title": "Design token consistency pass",
      "description": "As a developer, I need to ensure all budget components use Mjolnir's existing design tokens for consistent styling.",
      "acceptanceCriteria": [
        "Audit all components in components/budget/ — replace any hardcoded colours with CSS custom properties where appropriate",
        "Warning states use hsl(var(--warning)) token (amber-500, added in UX-9)",
        "Over-budget states use hsl(var(--destructive)) token",
        "Chart hex colours remain as hex strings (required for SVG rendering — do NOT convert to CSS variables)",
        "Typography uses existing Tailwind text classes consistently (text-sm, text-xs, font-medium, etc.)",
        "Border radius, spacing, and shadows match existing dashboard components (rounded-lg, p-4, shadow patterns)",
        "npm run build && npm run lint passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 9,
      "passes": false,
      "notes": ""
    },
    {
      "id": "B6-010",
      "title": "Budget navigation integration",
      "description": "As a user, I want budget pages accessible from the main navigation with sub-links.",
      "acceptanceCriteria": [
        "Update main navigation in lib/navigation.ts to include Budget section with sub-links: Dashboard (/budget), Transactions (/budget/transactions), Setup (/budget/setup)",
        "Active state highlighting on the current budget page in both sidebar and mobile nav",
        "Uncategorised badge (from B-3) shown next to Transactions sub-link",
        "Navigation works on both desktop sidebar and mobile hamburger menu",
        "npm run build && npm run lint passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 10,
      "passes": false,
      "notes": ""
    }
  ]
}
